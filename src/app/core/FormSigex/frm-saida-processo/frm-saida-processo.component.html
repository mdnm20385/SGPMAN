


<div id="modal" class="modal">
  <!--  -->
  <div mat-dialog-actions align="end">

    <button mat-raised-button mat-dialog-close color="warn" (click)="dialogRef.close()"> <mat-icon matSuffix>close</mat-icon></button>



  </div>

  <h2 mat-dialog-title ><span class="titulo">Registo de Saídas de Correspondências</span></h2>

  <mat-dialog-content>

            <mat-dialog-actions  align="end">
              <button mat-raised-button color="primary" type="button" (click)="SetarCombos()"><mat-icon>refresh</mat-icon>Refresh</button>
            </mat-dialog-actions>
    <form [formGroup]="registerForm" class="form-field-full" (ngSubmit)="Salvar()">


  <div class="row">
                <mat-form-field  class="col-sm-8">
                  <mat-label>Nome Completo(*)</mat-label>
                  <input matInput
                  formControlName="firstName" readonly="true">
                </mat-form-field>
                <mat-form-field class="col-sm-4">
                  <mat-label>Estado da junta(*)</mat-label>
                  <input matInput [readonly]="true"
                  formControlName="alterou">
                </mat-form-field>
              </div>
              <br/>
      <mat-tab-group>
        <mat-tab label="DADOS GERAIS">
        <br>
<mat-card>
  <mat-card-content>

    <div class="row">
      <div class="col-sm-4">
        <mat-form-field class="w-full">
          <input  hidden="true"  matInput formControlName="processoStamp">
          <input  hidden="true"  matInput formControlName="entradaStamp">
          <input  hidden="true"  matInput formControlName="saidaStamp">
          <input  hidden="true"  matInput formControlName="inseriu">
          <input  hidden="true"  matInput formControlName="alterou">
          <input  hidden="true"  matInput formControlName="inseriuDataHora">
          <input  hidden="true"  matInput formControlName="alterouDataHora">

          <mat-label>Órgão de Origem</mat-label>
          <mtx-select [items]="selectorgaos" formControlName="orgaoOrigem1"
            bindLabel="descricao" [loading]="loading" [hideSelected]="true"
            (change)="onSelectorgaoChange($event)"  (clear)="ClearDirecoes()"
            >
          </mtx-select>
        </mat-form-field>
      </div>
      <div class="col-sm-4">
        <mat-form-field class="w-full">
          <mat-label>Direcção de Origem</mat-label>
          <mtx-select [items]="selectdirecoes" formControlName="direcaoOrigem1"
            bindLabel="descricao" [loading]="loading"
            (change)="onDirecaoChange($event)"
            (clear)="onClearonDirecao()">
          </mtx-select>
        </mat-form-field>
      </div>

      <div class="col-sm-4">
        <mat-form-field class="w-full">
          <mat-label>Código de classificação</mat-label>
          <mtx-select [items]="selectespecie" formControlName="especieclas"
            bindLabel="ordem" [loading]="loading"  [hideSelected]="true"
             (change)="onEspecieChange($event)" (clear)="onClearonEspecie()"
            >
          </mtx-select>
        </mat-form-field>
      </div>

      <mat-form-field  class="col-sm-4">
        <mat-label>Assunto</mat-label>
        <input matInput [readonly]="true"  formControlName="tipoDoc">
        <mat-icon matSuffix>info</mat-icon>
      </mat-form-field>
      <mat-form-field  class="col-sm-4">
        <mat-label>Detalhes do assunto</mat-label>
        <textarea matInput formControlName="detalhesAssunto">
          </textarea>
          <mat-icon matSuffix>message</mat-icon>

      </mat-form-field>

      <mat-form-field  class="col-sm-4">
        <mat-label>Visado</mat-label>
        <textarea matInput placeholder="introduza o proprietário do documento, se existir ..."
        formControlName="visado"></textarea>
        <mat-icon matSuffix>person</mat-icon>

          </mat-form-field>

      <div class="col-sm-4">
        <mat-form-field class="w-full">
          <mat-label>Estado de tramitação</mat-label>
          <mtx-select [items]="EstadoTramitacao"
            bindLabel="descricao" [loading]="loading"
             bindValue="descricao" autofocus
            [(ngModel)]="selectedestadoe" formControlName="estadotramitat"

             (change)="onEstadotramitacaChange($event)"

             (clear)="onClearEstadotramitaca()">
          </mtx-select>
        </mat-form-field>
      </div>

      <div class="col-sm-4">
        <mat-form-field>
          <mat-label>Data de documento</mat-label>
          <input matInput [matDatepicker]="picker2"
           placeholder="Data de documento" formControlName="dataDocumento">
          <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
          <mat-datepicker #picker2></mat-datepicker>
        </mat-form-field>
      </div>

      <div class="col-sm-4">
        <mat-form-field>
          <mat-label>Remetente</mat-label>
          <input matInput placeholder="Quem está a remeter este documento?..."
          formControlName="inseriu"  readonly="true">
          <mat-icon matSuffix>person</mat-icon>
        </mat-form-field>
      </div>

      <div class="col-sm-4">
        <mat-form-field>
          <mat-label>Nº de Documento</mat-label>
          <input matInput placeholder="Número de entrada" type="number"
          formControlName="numeroSaida" >
        </mat-form-field>
      </div>

      <div class="col-sm-4">
        <mat-form-field class="w-full">
          <mat-label>Grau de Confidencialidade</mat-label>
          <mtx-select [items]="GrauConfidencialidade"
            bindLabel="descricao" [loading]="loading" [hideSelected]="true" formControlName="grauconf"
            (change)="ongrauClassifiChange($event)"  (clear)="onCleargrauClassifi()"
            >
          </mtx-select>
        </mat-form-field>
      </div>

      <div class="col-sm-4">
        <mat-form-field class="w-full">
          <mat-label>Grau de urgencia</mat-label>
          <mtx-select [items]="GrauUrgencia"
            bindLabel="descricao" [loading]="loading" [hideSelected]="true"
            formControlName="nvlUrgencias"
             (change)="onnvlUrgenciaChange($event)" (clear)="onClearvlUrgenciaChange()">
          </mtx-select>
        </mat-form-field>
      </div>

    </div>
  </mat-card-content>
</mat-card>
        </mat-tab>

        <mat-tab label="OUTROS DADOS">
<br>
<mat-card>
  <mat-card-content>
    <div class="row">

      <div class="col-sm-4">
        <mat-form-field>
          <mat-label>Qtd Folhas</mat-label>
          <input matInput placeholder="Qtd Folhas" type="number"
          formControlName="qtdFolhas">
        </mat-form-field>
      </div>

      <div class="col-sm-4">
        <mat-form-field>
          <mat-label>Qtd Anexos</mat-label>
          <input matInput placeholder="Qtd Anexos" type="number"
          formControlName="qtdAnexo">
        </mat-form-field>
      </div>
      <div class="col-sm-4">
        <mat-form-field>
          <mat-label>Qtd Exemplares</mat-label>
          <input matInput placeholder="Qtd Exemplares" type="number"
          formControlName="qtdExemplares">
        </mat-form-field>
      </div>


      </div>


    <div class="row">
      <mat-form-field  class="col-sm-12">
        <mat-label>Despacho</mat-label>
        <textarea matInput placeholder="Introduza o texto do Despacho se existir..."
        formControlName="despacho"></textarea>
      </mat-form-field>
      <mat-form-field  class="col-sm-12">
        <mat-label>Endereço</mat-label>
        <textarea matInput placeholder="introduz algum Endereço se existir ..."
        formControlName="endereco"></textarea>
      </mat-form-field>
    </div>
  </mat-card-content>
</mat-card>

        </mat-tab>

        <mat-tab label="DESTINATÁRIOS">




          <mat-card>
            <mat-card-content>




  <form>
          <div class="row">
            <div class="col-md-6 col-12">
               <mat-form-field>
          <mat-label></mat-label>
          <input matInput  type="text" readonly="true">
        </mat-form-field>
              <!-- <mat-form-field class="w-100">
                <mat-label>Destinatário</mat-label>
                <mtx-select [items]="dDestinatarioslista"
                  bindLabel="descricao" [loading]="loading"
                  bindValue="descricao" autofocus
                  [(ngModel)]="selectedestadoe" name="destinatario1"
                  (change)="onDestinatarioChange($event)"
                  (clear)="ClearDestinarios()">
                </mtx-select>
              </mat-form-field> -->
            </div>
            <div class="col-md-6 col-12">
              <mat-form-field appearance="outline" class="w-100">
  <mat-label>Filtragem através do Órgão/Direcção</mat-label>
  <input matInput
         placeholder="Filtragem através do Órgão/Direcção"
         class="inputpesquisa"
         (keyup)="busca($event)"
         #input />
  <button mat-icon-button matSuffix (click)="busca($event)">
    <mat-icon color="primary">search</mat-icon>
  </button>
</mat-form-field>
            </div>
          </div>
        </form>

          <div class="row">





          <!-- <div id="btnright">
            <mat-checkbox  style=" background-color: white;"  (change)="$event ? masterToggledmz() : null"


            [checked]="Seleccionartodos" >Seleccionar todos</mat-checkbox>
          </div> -->


          <mtx-grid [data]="listdestinatario"
  [columns]="columnsDestinatarios"
  [loading]="isLoadingdesti"
  [pageOnFront]="false"
  [loading]="isLoadingdesti"
  [columnResizable]="columnResizabledesti"
  [showToolbar]="showToolbardesti"
  [toolbarTitle]="'Marque somente um destinatário para cada saída'"
  [columnHideable]="columnHideabledesti"
  [columnSortable]="columnSortabledesti"
  [columnPinnable]="columnPinnabledesti"
  [pageOnFront]="showPaginatordesti"
  [showPaginator]="showPaginatordesti"
  [pageOnFront]="showPaginatordesti"
  [showPaginator]="showPaginatordesti"
  [rowHover]="true"
     (rowClick)="verNotificacion($event)"
                                   [length]="totalRecordsdest"
                                   [pageSize]="3"
                                   [pageIndex]="0"
                                   [pageSizeOptions]="[3,5, 10, 15]"



  >

</mtx-grid>

<ng-template #statusTpl let-row let-index="index" let-col="colDef">
<mat-checkbox [checked]="row.cibm">
</mat-checkbox>
</ng-template>
 </div>
            </mat-card-content>
          </mat-card>
                          </mat-tab>
        <mat-tab label="ANEXO">
          <br>
          <mat-card>
            <mat-card-content>
              <div *ngIf="isLoadingProcesso;then content else other_content">

              </div>
              <ng-template #content>

                  <div id="btnright">
                    <form   style="width: 50%;">
                        <mat-form-field class="m-x-4 example-full-width" appearance="outline">
                            <input matInput   matInput [(ngModel)]="query.q" name="q"
                             placeholder="Filtragem através do nome do ficheiro"
                             class="inputpesquisa"/>
                            <button matSuffix mat-raised-button color="accent" style="height: 35px;"
                            (click)="search()" (keyup.enter)="search()" class="btnpesquisa">
                                <mat-icon class='search-icon' color="primary" matSuffix>search</mat-icon>
                            </button>

                          </mat-form-field>
                    </form>
                </div>


                  <mtx-grid [data]="list"
                  [columns]="columns"
                  [loading]="isLoading"
                  [pageOnFront]="false"
                  [loading]="isLoading"
                  [columnResizable]="columnResizable"

                  [showToolbar]="showToolbar"
                  [toolbarTitle]="'Barra de ferramentas da grade de dados'"
                  [columnHideable]="columnHideable"
                  [columnSortable]="columnSortable"
                  [columnPinnable]="columnPinnable"
                  [pageOnFront]="showPaginator"
                  [showPaginator]="showPaginator"

                            (sortChange)="changeSort($event)"
                                                   [length]="totalRecords"
                                                   [pageSize]="50"
                                                   [pageSizeOptions]="[50, 100, 200]"
                            (page)="getNextPage($event)">
                  </mtx-grid>

                  <ng-template #expansionTpl let-row>
                  </ng-template>



              </ng-template>
              <ng-template #other_content>


                <br>
                <label for="fileInput" class="cus tom-file-label">📂  {{this.titulocarregar}}</label>
              <input type="file" id="fileInput" (change)="onFileChange($event)" hidden  title="Carregue o anexo da junta"/>

              <br/><span>{{ fileName || 'Nenhum ficheiro selecionado' }}</span>

              <br/>
                 <br/>


                                  <iframe
                                  *ngIf="safeUrl"
                                  [src]="safeUrl"
                                  width="100%"
                                  height="1000"
                                  webkitallowfullscreen
                                  mozallowfullscreen
                                  allowfullscreen
                                ></iframe>




              </ng-template>

            </mat-card-content>
          </mat-card>

        </mat-tab>

      </mat-tab-group>


      <div *ngIf="isLoadingProcesso;then contents else other_contents">

      </div>
      <ng-template #contents>

      <mat-dialog-actions  align="end">
        <button mat-raised-button color="primary" type="submit" [disabled]="true"><mat-icon>save</mat-icon></button>
      </mat-dialog-actions>
    </ng-template>
    <ng-template #other_contents>

      <mat-dialog-actions  align="end">
        <button mat-raised-button color="primary" type="submit" [disabled]="!!registerForm.invalid"><mat-icon>save</mat-icon></button>
      </mat-dialog-actions>
    </ng-template>

    </form>
    </mat-dialog-content>

</div>



