


<div id="modal" class="modal">
  <div mat-dialog-actions align="end">
    <button mat-raised-button mat-dialog-close color="warn" (click)="dialogRef.close()"> <mat-icon matSuffix>close</mat-icon></button>
  </div>
  <mat-dialog-content>
    <div class="row">
      <div class="col-sm-12">
        <mat-card>
          <mat-card-header>
            <mat-card-title>DIGITALIZAÃ‡ÃƒO DO ARQUIVO</mat-card-title>
          </mat-card-header>

          <mat-card-content>
            <form [formGroup]="registerForm" class="form-field-full" (ngSubmit)="Salvar()">

              <mat-tab-group>
                <mat-tab label="DADOS GERAIS">
                <br>

                               <div class="row">
                    <div class="col-sm-4">
                      <mat-form-field class="w-full">
                        <input  hidden="true"  matInput formControlName="processoStamp">
                        <input  hidden="true"  matInput formControlName="arquivoStamp">
                        <mat-label>Ã“rgÃ£o de Origem</mat-label>
                        <mtx-select [items]="selectorgaos" formControlName="orgaoOrigem1"
                          bindLabel="descricao" [loading]="loading" [hideSelected]="true"
                          (change)="onSelectorgaoChange($event)"  (clear)="ClearDirecoes()"
                          >
                        </mtx-select>
                      </mat-form-field>
                    </div>
                    <div class="col-sm-4">
                      <mat-form-field class="w-full">
                        <mat-label>DirecÃ§Ã£o de Origem</mat-label>
                        <mtx-select [items]="selectdirecoes" formControlName="direcaoOrigem1"
                          bindLabel="descricao" [loading]="loading"
                          (change)="onDirecaoChange($event)" (clear)="onClearDirecaoChange()"
                          >
                        </mtx-select>
                      </mat-form-field>
                    </div>

                    <div class="col-sm-4">
                      <mat-form-field class="w-full">
                        <mat-label>CÃ³digo de classificaÃ§Ã£o</mat-label>
                        <mtx-select [items]="selectespecie" formControlName="especieclas"
                          bindLabel="ordem" [loading]="loading"  [hideSelected]="true"
                           (change)="onEspecieChange($event)" (clear)="onClearEspecieChange()"
                          >
                        </mtx-select>
                      </mat-form-field>
                    </div>

                    <mat-form-field  class="col-sm-4">
                      <mat-label>Assunto</mat-label>
                      <input matInput [readonly]="true"  formControlName="tipoDoc">
                      <mat-icon matSuffix>info</mat-icon>
                    </mat-form-field>
                    <mat-form-field  class="col-sm-4">
                      <mat-label>Detalhes do assunto</mat-label>
                      <textarea matInput formControlName="detalhesAssunto">
                        </textarea>
                        <mat-icon matSuffix>message</mat-icon>

                    </mat-form-field>


                    <div class="col-sm-4">
                      <mat-form-field class="w-full">
                        <mat-label>Estado de tramitaÃ§Ã£o</mat-label>
                        <mtx-select [items]="EstadoTramitacao"
                          bindLabel="descricao" [loading]="loading"
                           bindValue="descricao" autofocus
                          [(ngModel)]="selectedestadoe" formControlName="estadotramitat"

                           (change)="onEstadotramitacaChange($event)"
                             (clear)="onClearEstadotramitacaChange()">
                        </mtx-select>
                      </mat-form-field>
                    </div>

                    <div class="col-sm-4">
                      <mat-form-field>
                        <mat-label>Data de Arquivo</mat-label>
                        <input matInput [matDatepicker]="picker2"
                         placeholder="Data de Arquivo" formControlName="dataArquivo">
                        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                        <mat-datepicker #picker2></mat-datepicker>
                      </mat-form-field>
                    </div>
                    <div class="col-sm-4">
                      <mat-form-field>
                        <mat-label>Estante</mat-label>
                        <input matInput placeholder="Em que estante estÃ¡ arquivado?..."
                        formControlName="localizacao" >
                        <mat-icon matSuffix>home</mat-icon>
                      </mat-form-field>
                    </div>
                    <mat-form-field  class="col-sm-4">
                      <mat-label>Pasta</mat-label>
                      <textarea matInput placeholder="introduza o nome da pasta, se existir ..."
                      formControlName="pasta"></textarea>
                      <mat-icon matSuffix>book</mat-icon>

                        </mat-form-field>


                    <div class="col-sm-4">
                      <mat-form-field>
                        <mat-label>NÂº de Arquivo</mat-label>
                        <input matInput placeholder="Ex: 25" type="number"
                        formControlName="numeroArquivo" >
                      </mat-form-field>
                    </div>

                    <div class="col-sm-4">
                      <mat-form-field class="w-full">
                        <mat-label>Grau de Confidencialidade</mat-label>
                        <mtx-select [items]="GrauConfidencialidade"
                          bindLabel="descricao" [loading]="loading"
                           [hideSelected]="true" formControlName="grauconf"
                          (change)="ongrauClassifiChange($event)" (clear)="onCleargrauClassifiChange()"
                          >
                        </mtx-select>
                      </mat-form-field>
                    </div>

                    <div class="col-sm-4">
                      <mat-form-field class="w-full">
                        <mat-label>Grau de urgencia</mat-label>
                        <mtx-select [items]="GrauUrgencia"
                          bindLabel="descricao" [loading]="loading" [hideSelected]="true"
                          formControlName="nvlUrgencias"
                           (change)="onnvlUrgenciaChange($event)" (clear)="onClearnvlUrgenciaChange()">
                        </mtx-select>
                      </mat-form-field>
                    </div>

                  </div>
                </mat-tab>

                <mat-tab label="PROCEDÃŠNCIA">

<mat-card>
  <mat-card-header>

    <mat-card-title>ProcedÃªncia</mat-card-title>
  </mat-card-header>
  <mat-card-content>
<div class="row">
  <div class="col-sm-6">
    <mat-form-field class="w-full">
      <mat-label>Ã“rgÃ£o de ProcedÃªncia</mat-label>
      <mtx-select [items]="selectorgaoprocede"  formControlName="orgaoproce1"
        bindLabel="descricao" [loading]="loading" [hideSelected]="true"
        (change)="onSelectorgaoprocendiaChange($event)"  (clear)="ClearDirecoesrocede()"
        >
      </mtx-select>
    </mat-form-field>
  </div>
  <div class="col-sm-6">
    <mat-form-field class="w-full">
      <mat-label>DirecÃ§Ã£o de ProcedÃªncia</mat-label>
      <mtx-select [items]="selectdirecoesproced" formControlName="direcaoproce1" [hideSelected]="true"
        bindLabel="descricao" [loading]="loading" (change)="onDirecaoprocendiaChange($event)"
        (clear)="onClearDirecaoprocendiaChange()"
        >
      </mtx-select>
    </mat-form-field>
  </div>
</div>
  </mat-card-content>
</mat-card>
                </mat-tab>
                <mat-tab label="OUTROS DADOS">
<br>
                  <div class="row">

                    <div class="col-sm-4">
                      <mat-form-field>
                        <mat-label>Qtd Folhas</mat-label>
                        <input matInput placeholder="Qtd Folhas" type="number"
                        formControlName="qtdFolhas">
                      </mat-form-field>
                    </div>

                    <div class="col-sm-4">
                      <mat-form-field>
                        <mat-label>Qtd Anexos</mat-label>
                        <input matInput placeholder="Qtd Anexos" type="number"
                        formControlName="qtdAnexo">
                      </mat-form-field>
                    </div>
                    <div class="col-sm-4">
                      <mat-form-field>
                        <mat-label>Qtd Exemplares</mat-label>
                        <input matInput placeholder="Qtd Exemplares" type="number"
                        formControlName="qtdExemplares">
                      </mat-form-field>
                    </div>


                    </div>


                  <div class="row">
                    <mat-form-field  class="col-sm-12">
                      <mat-label>Despacho</mat-label>
                      <textarea matInput placeholder="Introduza o texto do Despacho se existir..."
                      formControlName="despacho"></textarea>
                    </mat-form-field>
                    <mat-form-field  class="col-sm-12">
                      <mat-label>EndereÃ§o</mat-label>
                      <textarea matInput placeholder="introduz algum EndereÃ§o se existir ..."
                      formControlName="endereco"></textarea>
                    </mat-form-field>
                  </div>
                </mat-tab>

                <mat-tab label="ANEXO">
                  <br>
                  <div *ngIf="isLoadingProcesso;then content else other_content">

                  </div>
                  <ng-template #content>

                      <div id="btnright">
                        <form   style="width: 50%;">
                            <mat-form-field class="m-x-4 example-full-width" appearance="outline">
                                <input matInput   matInput [(ngModel)]="query.q" name="q"
                                 placeholder="Filtragem atravÃ©s do nome do ficheiro"
                                 class="inputpesquisa"/>
                                <button matSuffix mat-raised-button color="accent" style="height: 35px;"
                                (click)="search()" (keyup.enter)="search()" class="btnpesquisa">
                                    <mat-icon class='search-icon' color="primary" matSuffix>search</mat-icon>
                                </button>

                              </mat-form-field>
                        </form>
                    </div>
                      <mtx-grid [data]="list"
                      [columns]="columns"
                      [loading]="isLoading"
                      [pageOnFront]="false"
                      [loading]="isLoading"
                      [columnResizable]="columnResizable"
                      [multiSelectable]="multiSelectable"
                      [rowSelectable]="rowSelectable"
                      [hideRowSelectionCheckbox]="hideRowSelectionCheckbox"
                      [showToolbar]="showToolbar"
                      [toolbarTitle]="'Barra de ferramentas da grade de dados'"
                      [columnHideable]="columnHideable"
                      [columnSortable]="columnSortable"
                      [columnPinnable]="columnPinnable"
                      [pageOnFront]="showPaginator"
                      [showPaginator]="showPaginator"
                                (sortChange)="changeSort($event)"
                                                       [length]="totalRecords"
                                                       [pageSize]="50"
                                                       [pageSizeOptions]="[50, 100, 200]"
                                (page)="getNextPage($event)">
                      </mtx-grid>

                      <ng-template #expansionTpl let-row>
                      </ng-template>



                  </ng-template>
                  <ng-template #other_content>


                    <br>
                    <label for="fileInput" class="cus tom-file-label">ðŸ“‚  {{this.titulocarregar}}</label>
                  <input type="file" id="fileInput" (change)="onFileChange($event)" hidden  title="Carregue o anexo da junta"/>

                  <br/><span>{{ fileName || 'Nenhum ficheiro selecionado' }}</span>

                  <br/>
                     <br/>

                     <iframe
                     #iframeRef
                     *ngIf="safeUrl"
                     [src]="safeUrl"
                     width="100%"
                     height="1000"
                     webkitallowfullscreen
                     mozallowfullscreen
                     allowfullscreen
                     (load)="onIframeLoad()"
                   ></iframe>

                   <button *ngIf="isImageLoaded" (click)="imprimirIframe()">Imprimir</button>




                  </ng-template>

                </mat-tab>

              </mat-tab-group>


              <div *ngIf="isLoadingProcesso;then contents else other_contents">

              </div>
              <ng-template #contents>
                <mat-dialog-actions  align="end">
                  <button mat-raised-button color="primary" type="submit" [disabled]="!!registerForm.invalid"><mat-icon>save</mat-icon></button>
                </mat-dialog-actions>
              <!-- <mat-dialog-actions  align="end">
                <button mat-raised-button color="primary" type="submit" [disabled]="true"><mat-icon>save</mat-icon></button>
              </mat-dialog-actions> -->
            </ng-template>
            <ng-template #other_contents>

              <mat-dialog-actions  align="end">
                <button mat-raised-button color="primary" type="submit" [disabled]="!!registerForm.invalid"><mat-icon>save</mat-icon></button>
              </mat-dialog-actions>
            </ng-template>

            </form>
          </mat-card-content>
        </mat-card>
      </div>





       </div>
    </mat-dialog-content>

</div>



